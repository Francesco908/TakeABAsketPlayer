-- Loader for Take a Basket Player Script with Floating Button

-- Persistent GUI button based on file source
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local persistentGui = Instance.new("ScreenGui")
persistentGui.Name = "FluentPersistentButton"
persistentGui.Parent = playerGui
persistentGui.ResetOnSpawn = false
persistentGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
persistentGui.Enabled = true

local imageButton = Instance.new("ImageButton")
imageButton.Name = "PersistentControl"
imageButton.Size = UDim2.fromOffset(70, 70)
imageButton.Position = UDim2.new(0, 20, 0.5, -35)
imageButton.AnchorPoint = Vector2.new(0, 0.5)
imageButton.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
imageButton.BorderSizePixel = 0
imageButton.Image = "rbxassetid://6034684930"
imageButton.ScaleType = Enum.ScaleType.Fit
imageButton.BackgroundTransparency = 0.5
imageButton.ImageTransparency = 0.2
imageButton.Parent = persistentGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0.3, 0)
corner.Parent = imageButton

local dragging = false
local dragStart, startPos

local function onDragStart(input)
    dragging = true
    dragStart = input.Position
    startPos = imageButton.Position
end

local function onDragEnd()
    dragging = false
end

local function onDragMove(input)
    if dragging then
        local delta = input.Position - dragStart
        imageButton.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end

imageButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        onDragStart(input)
    end
end)

imageButton.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        onDragEnd()
    end
end)

imageButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        onDragMove(input)
    end
end)

-- Load Fluent GUI from GitHub on click
local guiLoaded = false
imageButton.MouseButton1Click:Connect(function()
    if guiLoaded then return end
    guiLoaded = true

    local url = "https://raw.githubusercontent.com/Francesco908/TakeABAsketPlayer/main/BASKET.lua"
    local success, result = pcall(function()
        return loadstring(game:HttpGet(url))()
    end)

    if not success then
        warn("[TakeABasketPlayer] Failed to load script from GitHub:", result)
    else
        print("[TakeABasketPlayer] Loaded successfully from:", url)
    end
end)

-- Rotate imageButton for visual effect
spawn(function()
    local rotation = 0
    while imageButton and imageButton.Parent do
        rotation = rotation + 2
        imageButton.Rotation = rotation
        RunService.Heartbeat:Wait()
    end
end)
